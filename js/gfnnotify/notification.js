/* 96d415c16212d51eae00ec87c2ad1b67d1371b04
 * Part of 'GoodForNothing Notification' for XenForo
 * Copyright Â© 2012-2015 GoodForNothing Labs
 * Licensed under GoodForNothing Labs' license agreement: https://gfnlabs.com/legal/license
 */
!function(d,c,a,e){var b=function(f){this.__construct(f)};c.GFNNotify=b;b.prototype={notifications:[],focused:true,queue:[],started:0,__construct:function(f){this.wrapper=f;this.init()},init:function(){this.url=this.wrapper.data("url");this.timer=parseInt(this.wrapper.data("timer"));this.interval=parseInt(this.wrapper.data("interval"));var f=this;d.extend(true,XenForo,{stackAlert:function(){f.call()}});this.call();d(c).focus(function(){this.focused=true});d(c).blur(function(){this.focused=false})},call:function(){var f=this;XenForo.ajax(this.url,{},function(g){if(typeof g.notifications!="undefined"){d.each(g.notifications,function(h,i){f.queue.push({id:h,item:d(i)})});f.process()}},{global:false,error:false})},process:function(){var f=this;if(this.started){return}this.started=setInterval(function(){if(!f.focused){return}if(f.queue.length<1){clearInterval(f.started);f.started=0;return}var g=0;f.queue=d.grep(f.queue,function(h){if(!f.focused){return true}setTimeout(function(){f.open(h.id,h.item)},g++*f.interval);return false})},2000)},open:function(h,g){var f=this;this.notifications[h]={};this.notifications[h].object=g;g.addClass("show");g.appendTo(this.wrapper);this.initNotification(h,g);f.notifications[h].timeout=setTimeout(function(){f.close(h)},f.timer)},close:function(g){var f=this.notifications[g];if(f){clearTimeout(f.timeout);f.object.removeClass("show");setTimeout(function(){f.object.addClass("hide");setTimeout(function(){f.object.remove()},1500)},25);this.notifications[g]=null}},initNotification:function(k,h){var g=this;var i=h.find(".notificationText");var j=i.find("> p");j.css("margin-top",function(){return(i.height()-j.outerHeight())/2});var f=j.find(".PopupItemLink").first().attr("href");h.click(function(l){l.preventDefault();g.close(k);XenForo.ajax(g.wrapper.data("mark-read"),{alert_id:h.data("alert-id")},function(){XenForo.redirect(f)},{global:false,error:false})})}};XenForo.register("#GFNNotification","GFNNotify")}(jQuery,this,document);