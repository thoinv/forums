!function(n){XenForo.Adv_Template_Picasa={init:function(t){var u=XenForo.Adv_Template_Picasa,r,f;if(t.hasClass("isMiu"))var e=t.attr("data-streched-width"),o=t.attr("data-normal-width"),i=t.attr("data-auto"),f=XenForo.MiuFramework.miu.selection;else{r=typeof tinyMCEPopup!="undefined"?tinyMCEPopup.editor:XenForo.tinymce.ed;var e=r.getParam("advtoolbar_template_strechedtitlewidth"),o=r.getParam("advtoolbar_template_normaltitlewidth"),i=r.getParam("advtoolbar_template_phrase_auto"),f=r.selection.getContent()}$picasa_width=t.find("#picasa_width"),$widthpx=t.find("#widthpx").hide(),$picasa_height=t.find("#picasa_height").hide(),$heightpx=t.find("#heightpx").hide(),$int_sec=t.find("#int_sec").hide(),$inputwidth=t.find("#ctrl_width"),$inputheight=t.find("#ctrl_height"),$inputint=t.find("#ctrl_int"),f.length!=0&&t.find("#ctrl_src").val(u.unescapeHtml(f,"space").replace(/\<[^\>]*\>/gi,"")),$inputwidth.one("focus",function(){n(this).val("")}).focus(function(){$widthpx.show("fast"),$picasa_height.show("fast"),n(this).val()==i&&n(this).val("")}).focusout(function(){var t=n(this).val(),r=new RegExp("[０-９]+");r.test(t)&&(t=u.zen2han(t),n(this).val(t)),(n(this).val().length==0||isNaN(n(this).val()))&&(n(this).val(i),$picasa_height.hide("fast"),$inputheight.val(i)),$widthpx.hide("fast")}),$inputheight.one("focus",function(){n(this).val("")}).focus(function(){$heightpx.show("fast"),n(this).val()==i&&n(this).val("")}).focusout(function(){var t=n(this).val(),r=new RegExp("[０-９]+");r.test(t)&&(t=u.zen2han(t),n(this).val(t)),(n(this).val().length==0||isNaN(n(this).val()))&&n(this).val(i),$heightpx.hide()}),$inputint.one("focus",function(){n(this).val("")}).focus(function(){$int_sec.show("fast"),n(this).val()==i&&n(this).val("")}).focusout(function(){var t=n(this).val(),r=new RegExp("[０-９]+");r.test(t)&&(t=u.zen2han(t),n(this).val(t)),(n(this).val().length==0||isNaN(n(this).val()))&&n(this).val(i),$int_sec.hide()})},zen2han:function(n){for(var t,r="",i=0,u=n.length;i<u;i++)t=n.charCodeAt(i),t=t>=65281&&t<=65392?t-65248:t,t=t===12540?45:t,r=r+String.fromCharCode(t);return r},unescapeHtml:function(n,t){n=n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'"),t=="space"&&(n=n.replace(/    /g,"\t").replace(/&nbsp;/g,"  ").replace(/<\/p>\n<p>/g,"\n"));var i=new RegExp("^<p>([\\s\\S]+)</p>$","i");return i.test(n)&&(n=n.match(i),n=n[1]),n}},XenForo.register("#adv_picasa","XenForo.Adv_Template_Picasa.init")}(jQuery,this,document);